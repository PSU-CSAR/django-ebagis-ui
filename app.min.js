angular.module("ebagis",["app.templates","auth"]),angular.module("auth",["app.templates","ngCookies","ngResource","ngSanitize","ngRoute"]).config(function(e){e.when("/",{templateUrl:"app-templates/auth/views/main.html",controller:"MainCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/register",{templateUrl:"app-templates/auth/views/register.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordReset",{templateUrl:"app-templates/auth/views/passwordreset.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordResetConfirm/:firstToken/:passwordResetToken",{templateUrl:"app-templates/auth/views/passwordresetconfirm.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/login",{templateUrl:"app-templates/auth/views/login.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/verifyEmail/:emailVerificationToken",{templateUrl:"app-templates/auth/views/verifyemail.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/logout",{templateUrl:"app-templates/auth/views/logout.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/userProfile",{templateUrl:"app-templates/auth/views/userprofile.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordChange",{templateUrl:"app-templates/auth/views/passwordchange.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/restricted",{templateUrl:"app-templates/auth/views/restricted.html",controller:"RestrictedCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/authRequired",{templateUrl:"app-templates/auth/views/authrequired.html",controller:"AuthrequiredCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus(!0)}]}}).otherwise({redirectTo:"/"})}).run(function(e){e.initialize("https://test.ebagis.geog.pdx.edu/api/rest/account",!1)}),angular.module("auth").controller("AuthrequiredCtrl",function(e){e.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("auth").controller("LoginCtrl",function(e,r,t,n){e.model={username:"",password:""},e.complete=!1,e.login=function(a){e.errors=[],n.form_validation(a,e.errors),a.$invalid||t.login(e.model.username,e.model.password).then(function(e){r.path("/")},function(r){e.errors=r})}}),angular.module("auth").controller("LogoutCtrl",function(e,r,t){t.logout()}),angular.module("auth").controller("MainCtrl",function(e,r,t,n){e.login=function(){n.login(prompt("Username"),prompt("password")).then(function(e){a(e)},o)},e.logout=function(){n.logout().then(a,o)},e.resetPassword=function(){n.resetPassword(prompt("Email")).then(a,o)},e.register=function(){n.register(prompt("Username"),prompt("Password"),prompt("Email")).then(a,o)},e.verify=function(){n.verify(prompt("Please enter verification code")).then(a,o)},e.goVerify=function(){t.path("/verifyEmail/"+prompt("Please enter verification code"))},e.changePassword=function(){n.changePassword(prompt("Password"),prompt("Repeat Password")).then(a,o)},e.profile=function(){n.profile().then(a,o)},e.updateProfile=function(){n.updateProfile({first_name:prompt("First Name"),last_name:prompt("Last Name"),email:prompt("Email")}).then(a,o)},e.confirmReset=function(){n.confirmReset(prompt("Code 1"),prompt("Code 2"),prompt("Password"),prompt("Repeat Password")).then(a,o)},e.goConfirmReset=function(){t.path("/passwordResetConfirm/"+prompt("Code 1")+"/"+prompt("Code 2"))};var a=function(r){e.response=r},o=function(r){e.response=r};e.show_login=!0,e.$on("djangoAuth.logged_in",function(r){e.show_login=!1}),e.$on("djangoAuth.logged_out",function(r){e.show_login=!0})}),angular.module("auth").controller("MasterCtrl",function(e,r,t){e.authenticated=!1,t.authenticationStatus(!0).then(function(){e.authenticated=!0}),e.$on("djangoAuth.logged_out",function(){e.authenticated=!1}),e.$on("djangoAuth.logged_in",function(){e.authenticated=!0}),e.$on("$routeChangeError",function(e,t,n,a){console.error("Unable to change routes.  Error: ",a),r.path("/restricted").replace()})}),angular.module("auth").controller("PasswordchangeCtrl",function(e,r,t){e.model={new_password1:"",new_password2:""},e.complete=!1,e.changePassword=function(n){e.errors=[],t.form_validation(n,e.errors),n.$invalid||r.changePassword(e.model.new_password1,e.model.new_password2).then(function(r){e.complete=!0},function(r){e.errors=r})}}),angular.module("auth").controller("PasswordresetCtrl",function(e,r,t){e.model={email:""},e.complete=!1,e.resetPassword=function(n){e.errors=[],t.form_validation(n,e.errors),n.$invalid||r.resetPassword(e.model.email).then(function(r){e.complete=!0},function(r){e.errors=r})}}),angular.module("auth").controller("PasswordresetconfirmCtrl",function(e,r,t,n){e.model={new_password1:"",new_password2:""},e.complete=!1,e.confirmReset=function(a){e.errors=[],n.form_validation(a,e.errors),a.$invalid||t.confirmReset(r.firstToken,r.passwordResetToken,e.model.new_password1,e.model.new_password2).then(function(r){e.complete=!0},function(r){e.errors=r})}}),angular.module("auth").controller("RegisterCtrl",function(e,r,t){e.model={username:"",password:"",email:""},e.complete=!1,e.register=function(n){e.errors=[],t.form_validation(n,e.errors),n.$invalid||r.register(e.model.username,e.model.password1,e.model.password2,e.model.email).then(function(r){e.complete=!0},function(r){e.errors=r})}}),angular.module("auth").controller("RestrictedCtrl",function(e,r){e.$on("djangoAuth.logged_in",function(){r.path("/")})}),angular.module("auth").controller("UserprofileCtrl",function(e,r,t){e.model={first_name:"",last_name:"",email:""},e.complete=!1,r.profile().then(function(r){e.model=r}),e.updateProfile=function(n,a){e.errors=[],t.form_validation(n,e.errors),n.$invalid||r.updateProfile(a).then(function(r){e.complete=!0},function(r){e.error=r})}}),angular.module("auth").controller("VerifyemailCtrl",function(e,r,t){t.verify(r.emailVerificationToken).then(function(r){e.success=!0},function(r){e.failure=!1})}),angular.module("auth").service("djangoAuth",function(e,r,t,n){var a={API_URL:"/api/rest/account",use_session:!1,authenticated:null,authPromise:null,request:function(n){t.get("token")&&(r.defaults.headers.common.Authorization="Token "+t.get("token")),i=n.params||{},n=n||{};var a=e.defer(),o=this.API_URL+n.url,s=n.method||"GET",i=i,l=n.data||{};return r({url:o,withCredentials:this.use_session,method:s.toUpperCase(),headers:{"X-CSRFToken":t.csrftoken},params:i,data:l}).success(angular.bind(this,function(e,r,t,n){a.resolve(e,r)})).error(angular.bind(this,function(e,r,t,n){console.log("error syncing with: "+o),e&&(e.status=r),0==r&&(""==e&&(e={},e.status=0,e.non_field_errors=["Could not connect. Please try again."]),null==e&&(e={},e.status=0,e.non_field_errors=["Server timed out. Please try again."])),a.reject(e,r,t,n)})),a.promise},register:function(e,r,t,n,a){var o={username:e,password1:r,password2:t,email:n};return o=angular.extend(o,a),this.request({method:"POST",url:"/registration/",data:o})},login:function(e,a){var o=this;return this.request({method:"POST",url:"/login/",data:{username:e,password:a}}).then(function(e){o.use_session||(r.defaults.headers.common.Authorization="Token "+e.key,t.put("token",e.key)),o.authenticated=!0,n.$broadcast("djangoAuth.logged_in",e)})},logout:function(){var e=this;return this.request({method:"POST",url:"/logout/"}).then(function(a){delete r.defaults.headers.common.Authorization,t.remove("token"),e.authenticated=!1,n.$broadcast("djangoAuth.logged_out")})},changePassword:function(e,r){return this.request({method:"POST",url:"/password/change/",data:{new_password1:e,new_password2:r}})},resetPassword:function(e){return this.request({method:"POST",url:"/password/reset/",data:{email:e}})},profile:function(){return this.request({method:"GET",url:"/user/"})},updateProfile:function(e){return this.request({method:"PATCH",url:"/user/",data:e})},verify:function(e){return this.request({method:"POST",url:"/registration/verify-email/",data:{key:e}})},confirmReset:function(e,r,t,n){return this.request({method:"POST",url:"/password/reset/confirm/",data:{uid:e,token:r,new_password1:t,new_password2:n}})},authenticationStatus:function(r,t){r=r||!1,t=t||!1,(null==this.authPromise||t)&&(this.authPromise=this.request({method:"GET",url:"/user/"}));var n=this,a=e.defer();return null==this.authenticated||t?this.authPromise.then(function(){n.authenticated=!0,a.resolve()},function(){n.authenticated=!1,r?a.reject("User is not logged in."):a.resolve()}):0==this.authenticated&&r?a.reject("User is not logged in."):a.resolve(),a.promise},initialize:function(e,r){return this.API_URL=e,this.use_session=r,this.authenticationStatus()}};return a}),angular.module("auth").service("Validate",function(){return{message:{minlength:"This value is not long enough.",maxlength:"This value is too long.",email:"A properly formatted email address is required.",required:"This field is required."},more_messages:{demo:{required:"Here is a sample alternative required message."}},check_more_messages:function(e,r){return(this.more_messages[e]||[])[r]||null},validation_messages:function(e,r,t){var n=[];for(var a in r[e].$error)if(r[e].$error[a]){var o=this.check_more_messages(e,a);o?n.push(o):this.message[a]?n.push(this.message[a]):n.push("Error: "+a)}var s=[];angular.forEach(n,function(e,r){-1===s.indexOf(e)&&s.push(e)}),t&&(t[e]=s)},form_validation:function(e,r){for(var t in e)"$"!=t.substr(0,1)&&this.validation_messages(t,e,r)}}}),angular.module("app.templates",[]).run(["$templateCache",function(e){e.put("app-templates/auth/views/authrequired.html","<p>This is a restricted view.  You must be authenticated to view it.</p>\r\n"),e.put("app-templates/auth/views/login.html",'<div id="login_view" ng-controller="LoginCtrl">\r\n  <form role="form" ng-submit="login(loginForm)" name="loginForm" novalidate>\r\n    <div class="form-group">\r\n      <label for="id_username">Username</label>\r\n      <input name="username" id="id_username" type="text" ng-model="model.username" placeholder="Username" class="form-control" required />\r\n    </div>\r\n    <div class="alert alert-danger" ng-repeat="error in errors.username">{{error}}</div>\r\n    <div class="form-group">\r\n      <label for="id_password">Password</label>\r\n      <input name="password" id="id_password" type="password" ng-model="model.password" placeholder="Password" class="form-control" required />\r\n    </div>\r\n    <div class="alert alert-danger" ng-repeat="error in errors.password">{{error}}</div>\r\n    <div class="alert alert-danger" ng-repeat="error in errors.non_field_errors">{{error}}</div>\r\n    <div class="alert alert-danger" ng-if="error">{{error}}</div>\r\n    <button type="submit" class="btn btn-primary">Login</button>\r\n  </form>\r\n</div>\r\n'),e.put("app-templates/auth/views/logout.html",'<div id="logout_view" ng-controller="LogoutCtrl">\r\n	<div class="alert alert-info">You have logged out.</div>\r\n</div>'),e.put("app-templates/auth/views/main.html",'<h4>Routes</h4>\r\n    <p>\r\n        <a ng-hide="authenticated" href="#/login" class="btn btn-primary">Login</a>\r\n        <a ng-hide="authenticated" href="#/passwordReset" class="btn btn-primary">Send Password Reset</a>\r\n        <a ng-hide="authenticated" ng-click="goConfirmReset()" class="btn btn-primary">Confirm Password Reset</a>\r\n    </p>\r\n    <p>\r\n        <a ng-show="authenticated" href="#/logout" class="btn btn-primary">Logout</a>\r\n        <a ng-hide="authenticated" ng-href="#/register" class="btn btn-primary">Register</a>\r\n        <a ng-click="goVerify()" class="btn btn-primary">Verify Email</a>\r\n        <a ng-show="authenticated" href="#/passwordChange" class="btn btn-primary">Change Password</a>\r\n        <a ng-show="authenticated" href="#/userProfile" class="btn btn-primary">Profile</a>\r\n        <a href="#/authRequired" class="btn btn-primary">Restricted Page</a>\r\n    </p>\r\n<hr/>\r\n<h4>Kitchen Sink Demo</h4>\r\n<div style="margin-bottom:25px;">\r\n  <div style="margin-bottom:15px;">\r\n    <button ng-hide="authenticated" ng-click="login()" class="btn btn-primary">Login</button>\r\n    <button ng-show="authenticated" ng-click="logout()" class="btn btn-primary">Logout</button>\r\n    <button ng-hide="authenticated" ng-click="resetPassword()" class="btn btn-primary">Send Password Reset</button>\r\n    <button ng-hide="authenticated" ng-click="confirmReset()" class="btn btn-primary">Confirm Password Reset</button>\r\n    <button ng-hide="authenticated" ng-click="register()" class="btn btn-primary">Register</button>\r\n    <button ng-click="verify()" class="btn btn-primary">Verify Email</button>\r\n    <button ng-show="authenticated" ng-click="changePassword()" class="btn btn-primary">Change Password</button>\r\n    <button ng-show="authenticated" ng-click="profile()" class="btn btn-primary">Get Profile</button>\r\n    <button ng-show="authenticated" ng-click="updateProfile()" class="btn btn-primary">Update Profile</button>\r\n  </div>\r\n\r\n  <p><textarea style="width:90%;height:200px;">{{response}}</textarea></p>\r\n\r\n</div>\r\n\r\n<hr/>\r\n<h4>ngInclude Demo - Login</h4>\r\n<div ng-if="show_login" ng-include="\'app-templates/auth/views/login.html\'"></div>\r\n<div ng-if="!show_login" class="alert alert-info">You have logged in.</div>\r\n\r\n\r\n<div class="footer">\r\n  <p>Tivix</p>\r\n</div>\r\n\r\n'),e.put("app-templates/auth/views/passwordchange.html",'<div id="passwordChange_view" ng-controller="PasswordchangeCtrl">\r\n    <div ng-if="complete == false">\r\n        <form role="form" ng-submit="changePassword(changePasswordForm)" name="changePasswordForm" ng-if="authenticated" novalidate>\r\n            <div class="form-group">\r\n                <label for="id_password1">New Password</label>\r\n                <input name="new_password1" id="id_password1" type="password" ng-model="model.new_password1" placeholder="New Password" class="form-control" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.new_password1">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_password2">Repeat Password</label>\r\n                <input name="new_password2" id="id_password2" type="password" ng-model="model.new_password2" placeholder="Repeat Password" class="form-control" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.new_password2">{{error}}</div>\r\n            <button ng-show="authenticated" type="submit" class="btn btn-primary">Change Password</button>\r\n        </form>\r\n        <div class="alert alert-warning" ng-if="authenticated != true">You need to be logged in to do this!</div>\r\n    </div>\r\n    <div ng-if="complete == true">\r\n        <div class="alert alert-success">You have changed your password.</div>\r\n    </div>\r\n</div>\r\n'),e.put("app-templates/auth/views/passwordreset.html",'<div id="passwordReset_view" ng-controller="PasswordresetCtrl">\r\n    <div ng-if="complete == false">\r\n        <form role="form" ng-if="authenticated != true" name="passwordResetForm" ng-submit="resetPassword(passwordResetForm)" novalidate>\r\n            <div class="form-group">\r\n                <label for="id_email">Email</label>\r\n                <input name="email" id="id_email" type="text" ng-model="model.email" placeholder="Email" class="form-control" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\r\n            <button ng-hide="authenticated" type="submit" class="btn btn-primary">Reset Password</button>\r\n        </form>\r\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to reset your password.</p>\r\n    </div>\r\n    <div ng-if="complete == true">\r\n        <div class="alert alert-success">You should receive an email shortly with instructions on how to reset your account password.</div>\r\n    </div>\r\n</div>\r\n'),e.put("app-templates/auth/views/passwordresetconfirm.html",'<div id="passwordResetConfirm_view" ng-controller="PasswordresetconfirmCtrl">\r\n    <div ng-if="complete == false">\r\n        <form role="form" ng-if="authenticated != true" ng-submit="confirmReset(confirmResetForm)" name="confirmResetForm" novalidate>\r\n            <div class="form-group">\r\n                <label for="id_password1">New Password</label>\r\n                <input name="password1" id="id_password1" type="password" ng-model="model.new_password1" placeholder="New Password" class="form-control" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.password1">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_password2">Repeat Password</label>\r\n                <input name="password2" id="id_password2" type="password" ng-model="model.new_password2" placeholder="Repeat Password" class="form-control" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.password2">{{error}}</div>\r\n            <button type="submit" ng-hide="authenticated" class="btn btn-primary">Reset Password</button>\r\n        </form>\r\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to reset your password.</p>\r\n    </div>\r\n    <div ng-if="complete == true">\r\n        <div class="alert alert-success">You have changed your password.</div>\r\n    </div>\r\n</div>\r\n'),e.put("app-templates/auth/views/register.html",'<div id="register_view" ng-controller="RegisterCtrl">\r\n    <div ng-if="complete == false">\r\n        <form role="form" ng-if="authenticated != true" name="registerForm" ng-submit="register(registerForm)" novalidate>\r\n            <div class="form-group">\r\n                <label for="id_username">Username</label>\r\n                <input name="username" id="id_username" class="form-control" type="text" ng-model="model.username" placeholder="Username" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.username">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_password">Password</label>\r\n                <input name="password1" id="id_password1" class="form-control" type="password" ng-model="model.password1" placeholder="Password" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.password1">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_password">Repeat Password</label>\r\n                <input name="password" id="id_password2" class="form-control" type="password" ng-model="model.password2" placeholder="Repeat Password" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.password2">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_email">Email</label>\r\n                <input name="email" id="id_email" class="form-control" type="email" ng-model="model.email" placeholder="Email" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\r\n            <button ng-hide="authenticated" type="submit" class="btn btn-primary">Register</button>\r\n        </form>\r\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to register.</p>\r\n    </div>\r\n    <div ng-if="complete == true">\r\n        <div class="alert alert-success">Great!  You\'ve just registered.  You should receive an email shortly with instructions on how to activate your account.</div>\r\n    </div>\r\n</div>'),e.put("app-templates/auth/views/restricted.html","<p>You have attempted to access a restricted page.  Please login to continue.</p>\r\n<div ng-include=\"'app-templates/auth/views/login.html'\"></div>\r\n"),e.put("app-templates/auth/views/userprofile.html",'<div id="userProfile_view" ng-controller="UserprofileCtrl">\r\n    <div ng-if="complete == false">\r\n        <form role="form" ng-if="authenticated" name="userProfileForm" ng-submit="updateProfile(userProfileForm, model)" novalidate>\r\n            <div class="form-group">\r\n                <label for="id_first_name">First Name</label>\r\n                <input name="first_name" id="id_first_name" class="form-control" type="text" ng-model="model.first_name" placeholder="First Name" />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.first_name">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_last_name">Last Name</label>\r\n                <input name="last_name" id="id_last_name" class="form-control" type="text" ng-model="model.last_name" placeholder="Last Name" />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.last_name">{{error}}</div>\r\n            <div class="form-group">\r\n                <label for="id_email">Email</label>\r\n                <input name="email" id="id_email" class="form-control" type="email" ng-model="model.email" placeholder="Email" required />\r\n            </div>\r\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\r\n            <button type="submit" ng-show="authenticated" class="btn btn-primary">Update Profile</button>\r\n        </form>\r\n        <div class="alert alert-warning" ng-if="authenticated == false">You need to be logged in to do this.</div>\r\n    </div>\r\n    <div ng-if="complete == true">\r\n        <div class="alert alert-success">You have updated your profile.</div>\r\n    </div>\r\n</div>\r\n'),e.put("app-templates/auth/views/verifyemail.html",'<div id="verifyEmail_view" ng-controller="VerifyemailCtrl">\r\n	<div ng-if="success" class="alert alert-success">You have successfully verified your email address.</div>\r\n	<div ng-if="failure" class="alert alert-warning">Sorry, there\'s been an error.</div>\r\n</div>\r\n')}]);
//# sourceMappingURL=app.min.js.map
