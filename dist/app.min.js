angular.module("ebagis",["app.templates","auth"]),angular.module("auth",["app.templates","ngCookies","ngResource","ngSanitize","ngRoute"]).config(function(e){e.when("/",{templateUrl:"app-templates/auth/views/main.html",controller:"MainCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/register",{templateUrl:"app-templates/auth/views/register.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordReset",{templateUrl:"app-templates/auth/views/passwordreset.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordResetConfirm/:firstToken/:passwordResetToken",{templateUrl:"app-templates/auth/views/passwordresetconfirm.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/login",{templateUrl:"app-templates/auth/views/login.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/verifyEmail/:emailVerificationToken",{templateUrl:"app-templates/auth/views/verifyemail.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/logout",{templateUrl:"app-templates/auth/views/logout.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/userProfile",{templateUrl:"app-templates/auth/views/userprofile.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/passwordChange",{templateUrl:"app-templates/auth/views/passwordchange.html",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/restricted",{templateUrl:"app-templates/auth/views/restricted.html",controller:"RestrictedCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus()}]}}).when("/authRequired",{templateUrl:"app-templates/auth/views/authrequired.html",controller:"AuthrequiredCtrl",resolve:{authenticated:["djangoAuth",function(e){return e.authenticationStatus(!0)}]}}).otherwise({redirectTo:"/"})}).run(function(e){e.initialize("https://test.ebagis.geog.pdx.edu/api/rest/account",!1)}),angular.module("auth").controller("AuthrequiredCtrl",function(e){e.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("auth").controller("LoginCtrl",function(e,t,r,n){e.model={username:"",password:""},e.complete=!1,e.login=function(a){e.errors=[],n.form_validation(a,e.errors),a.$invalid||r.login(e.model.username,e.model.password).then(function(e){t.path("/")},function(t){e.errors=t})}}),angular.module("auth").controller("LogoutCtrl",function(e,t,r){r.logout()}),angular.module("auth").controller("MainCtrl",function(e,t,r,n){e.login=function(){n.login(prompt("Username"),prompt("password")).then(function(e){a(e)},o)},e.logout=function(){n.logout().then(a,o)},e.resetPassword=function(){n.resetPassword(prompt("Email")).then(a,o)},e.register=function(){n.register(prompt("Username"),prompt("Password"),prompt("Email")).then(a,o)},e.verify=function(){n.verify(prompt("Please enter verification code")).then(a,o)},e.goVerify=function(){r.path("/verifyEmail/"+prompt("Please enter verification code"))},e.changePassword=function(){n.changePassword(prompt("Password"),prompt("Repeat Password")).then(a,o)},e.profile=function(){n.profile().then(a,o)},e.updateProfile=function(){n.updateProfile({first_name:prompt("First Name"),last_name:prompt("Last Name"),email:prompt("Email")}).then(a,o)},e.confirmReset=function(){n.confirmReset(prompt("Code 1"),prompt("Code 2"),prompt("Password"),prompt("Repeat Password")).then(a,o)},e.goConfirmReset=function(){r.path("/passwordResetConfirm/"+prompt("Code 1")+"/"+prompt("Code 2"))};var a=function(t){e.response=t},o=function(t){e.response=t};e.show_login=!0,e.$on("djangoAuth.logged_in",function(t){e.show_login=!1}),e.$on("djangoAuth.logged_out",function(t){e.show_login=!0})}),angular.module("auth").controller("MasterCtrl",function(e,t,r){e.authenticated=!1,r.authenticationStatus(!0).then(function(){e.authenticated=!0}),e.$on("djangoAuth.logged_out",function(){e.authenticated=!1}),e.$on("djangoAuth.logged_in",function(){e.authenticated=!0}),e.$on("$routeChangeError",function(e,r,n,a){console.error("Unable to change routes.  Error: ",a),t.path("/restricted").replace()})}),angular.module("auth").controller("PasswordchangeCtrl",function(e,t,r){e.model={new_password1:"",new_password2:""},e.complete=!1,e.changePassword=function(n){e.errors=[],r.form_validation(n,e.errors),n.$invalid||t.changePassword(e.model.new_password1,e.model.new_password2).then(function(t){e.complete=!0},function(t){e.errors=t})}}),angular.module("auth").controller("PasswordresetCtrl",function(e,t,r){e.model={email:""},e.complete=!1,e.resetPassword=function(n){e.errors=[],r.form_validation(n,e.errors),n.$invalid||t.resetPassword(e.model.email).then(function(t){e.complete=!0},function(t){e.errors=t})}}),angular.module("auth").controller("PasswordresetconfirmCtrl",function(e,t,r,n){e.model={new_password1:"",new_password2:""},e.complete=!1,e.confirmReset=function(a){e.errors=[],n.form_validation(a,e.errors),a.$invalid||r.confirmReset(t.firstToken,t.passwordResetToken,e.model.new_password1,e.model.new_password2).then(function(t){e.complete=!0},function(t){e.errors=t})}}),angular.module("auth").controller("RegisterCtrl",function(e,t,r){e.model={username:"",password:"",email:""},e.complete=!1,e.register=function(n){e.errors=[],r.form_validation(n,e.errors),n.$invalid||t.register(e.model.username,e.model.password1,e.model.password2,e.model.email).then(function(t){e.complete=!0},function(t){e.errors=t})}}),angular.module("auth").controller("RestrictedCtrl",function(e,t){e.$on("djangoAuth.logged_in",function(){t.path("/")})}),angular.module("auth").controller("UserprofileCtrl",function(e,t,r){e.model={first_name:"",last_name:"",email:""},e.complete=!1,t.profile().then(function(t){e.model=t}),e.updateProfile=function(n,a){e.errors=[],r.form_validation(n,e.errors),n.$invalid||t.updateProfile(a).then(function(t){e.complete=!0},function(t){e.error=t})}}),angular.module("auth").controller("VerifyemailCtrl",function(e,t,r){r.verify(t.emailVerificationToken).then(function(t){e.success=!0},function(t){e.failure=!1})}),angular.module("auth").service("djangoAuth",function(e,t,r,n){var a={API_URL:"/api/rest/account",use_session:!1,authenticated:null,authPromise:null,request:function(n){r.get("token")&&(t.defaults.headers.common.Authorization="Token "+r.get("token")),i=n.params||{},n=n||{};var a=e.defer(),o=this.API_URL+n.url,s=n.method||"GET",i=i,l=n.data||{};return t({url:o,withCredentials:this.use_session,method:s.toUpperCase(),headers:{"X-CSRFToken":r.csrftoken},params:i,data:l}).success(angular.bind(this,function(e,t,r,n){a.resolve(e,t)})).error(angular.bind(this,function(e,t,r,n){console.log("error syncing with: "+o),e&&(e.status=t),0==t&&(""==e&&(e={},e.status=0,e.non_field_errors=["Could not connect. Please try again."]),null==e&&(e={},e.status=0,e.non_field_errors=["Server timed out. Please try again."])),a.reject(e,t,r,n)})),a.promise},register:function(e,t,r,n,a){var o={username:e,password1:t,password2:r,email:n};return o=angular.extend(o,a),this.request({method:"POST",url:"/registration/",data:o})},login:function(e,a){var o=this;return this.request({method:"POST",url:"/login/",data:{username:e,password:a}}).then(function(e){o.use_session||(t.defaults.headers.common.Authorization="Token "+e.key,r.put("token",e.key)),o.authenticated=!0,n.$broadcast("djangoAuth.logged_in",e)})},logout:function(){var e=this;return this.request({method:"POST",url:"/logout/"}).then(function(a){delete t.defaults.headers.common.Authorization,r.remove("token"),e.authenticated=!1,n.$broadcast("djangoAuth.logged_out")})},changePassword:function(e,t){return this.request({method:"POST",url:"/password/change/",data:{new_password1:e,new_password2:t}})},resetPassword:function(e){return this.request({method:"POST",url:"/password/reset/",data:{email:e}})},profile:function(){return this.request({method:"GET",url:"/user/"})},updateProfile:function(e){return this.request({method:"PATCH",url:"/user/",data:e})},verify:function(e){return this.request({method:"POST",url:"/registration/verify-email/",data:{key:e}})},confirmReset:function(e,t,r,n){return this.request({method:"POST",url:"/password/reset/confirm/",data:{uid:e,token:t,new_password1:r,new_password2:n}})},authenticationStatus:function(t,r){t=t||!1,r=r||!1,(null==this.authPromise||r)&&(this.authPromise=this.request({method:"GET",url:"/user/"}));var n=this,a=e.defer();return null==this.authenticated||r?this.authPromise.then(function(){n.authenticated=!0,a.resolve()},function(){n.authenticated=!1,t?a.reject("User is not logged in."):a.resolve()}):0==this.authenticated&&t?a.reject("User is not logged in."):a.resolve(),a.promise},initialize:function(e,t){return this.API_URL=e,this.use_session=t,this.authenticationStatus()}};return a}),angular.module("auth").service("Validate",function(){return{message:{minlength:"This value is not long enough.",maxlength:"This value is too long.",email:"A properly formatted email address is required.",required:"This field is required."},more_messages:{demo:{required:"Here is a sample alternative required message."}},check_more_messages:function(e,t){return(this.more_messages[e]||[])[t]||null},validation_messages:function(e,t,r){var n=[];for(var a in t[e].$error)if(t[e].$error[a]){var o=this.check_more_messages(e,a);o?n.push(o):this.message[a]?n.push(this.message[a]):n.push("Error: "+a)}var s=[];angular.forEach(n,function(e,t){-1===s.indexOf(e)&&s.push(e)}),r&&(r[e]=s)},form_validation:function(e,t){for(var r in e)"$"!=r.substr(0,1)&&this.validation_messages(r,e,t)}}}),angular.module("app.templates",[]).run(["$templateCache",function(e){e.put("app-templates/auth/views/authrequired.html","<p>This is a restricted view.  You must be authenticated to view it.</p>\n"),e.put("app-templates/auth/views/login.html",'<div id="login_view" ng-controller="LoginCtrl">\n  <form role="form" ng-submit="login(loginForm)" name="loginForm" novalidate>\n    <div class="form-group">\n      <label for="id_username">Username</label>\n      <input name="username" id="id_username" type="text" ng-model="model.username" placeholder="Username" class="form-control" required />\n    </div>\n    <div class="alert alert-danger" ng-repeat="error in errors.username">{{error}}</div>\n    <div class="form-group">\n      <label for="id_password">Password</label>\n      <input name="password" id="id_password" type="password" ng-model="model.password" placeholder="Password" class="form-control" required />\n    </div>\n    <div class="alert alert-danger" ng-repeat="error in errors.password">{{error}}</div>\n    <div class="alert alert-danger" ng-repeat="error in errors.non_field_errors">{{error}}</div>\n    <div class="alert alert-danger" ng-if="error">{{error}}</div>\n    <button type="submit" class="btn btn-primary">Login</button>\n  </form>\n</div>\n'),e.put("app-templates/auth/views/logout.html",'<div id="logout_view" ng-controller="LogoutCtrl">\n	<div class="alert alert-info">You have logged out.</div>\n</div>'),e.put("app-templates/auth/views/main.html",'<h4>Routes</h4>\n    <p>\n        <a ng-hide="authenticated" href="#/login" class="btn btn-primary">Login</a>\n        <a ng-hide="authenticated" href="#/passwordReset" class="btn btn-primary">Send Password Reset</a>\n        <a ng-hide="authenticated" ng-click="goConfirmReset()" class="btn btn-primary">Confirm Password Reset</a>\n    </p>\n    <p>\n        <a ng-show="authenticated" href="#/logout" class="btn btn-primary">Logout</a>\n        <a ng-hide="authenticated" ng-href="#/register" class="btn btn-primary">Register</a>\n        <a ng-click="goVerify()" class="btn btn-primary">Verify Email</a>\n        <a ng-show="authenticated" href="#/passwordChange" class="btn btn-primary">Change Password</a>\n        <a ng-show="authenticated" href="#/userProfile" class="btn btn-primary">Profile</a>\n        <a href="#/authRequired" class="btn btn-primary">Restricted Page</a>\n    </p>\n<hr/>\n<h4>Kitchen Sink Demo</h4>\n<div style="margin-bottom:25px;">\n  <div style="margin-bottom:15px;">\n    <button ng-hide="authenticated" ng-click="login()" class="btn btn-primary">Login</button>\n    <button ng-show="authenticated" ng-click="logout()" class="btn btn-primary">Logout</button>\n    <button ng-hide="authenticated" ng-click="resetPassword()" class="btn btn-primary">Send Password Reset</button>\n    <button ng-hide="authenticated" ng-click="confirmReset()" class="btn btn-primary">Confirm Password Reset</button>\n    <button ng-hide="authenticated" ng-click="register()" class="btn btn-primary">Register</button>\n    <button ng-click="verify()" class="btn btn-primary">Verify Email</button>\n    <button ng-show="authenticated" ng-click="changePassword()" class="btn btn-primary">Change Password</button>\n    <button ng-show="authenticated" ng-click="profile()" class="btn btn-primary">Get Profile</button>\n    <button ng-show="authenticated" ng-click="updateProfile()" class="btn btn-primary">Update Profile</button>\n  </div>\n\n  <p><textarea style="width:90%;height:200px;">{{response}}</textarea></p>\n\n</div>\n\n<hr/>\n<h4>ngInclude Demo - Login</h4>\n<div ng-if="show_login" ng-include="\'app-templates/auth/views/login.html\'"></div>\n<div ng-if="!show_login" class="alert alert-info">You have logged in.</div>\n\n\n<div class="footer">\n  <p>Tivix</p>\n</div>\n\n'),e.put("app-templates/auth/views/passwordchange.html",'<div id="passwordChange_view" ng-controller="PasswordchangeCtrl">\n    <div ng-if="complete == false">\n        <form role="form" ng-submit="changePassword(changePasswordForm)" name="changePasswordForm" ng-if="authenticated" novalidate>\n            <div class="form-group">\n                <label for="id_password1">New Password</label>\n                <input name="new_password1" id="id_password1" type="password" ng-model="model.new_password1" placeholder="New Password" class="form-control" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.new_password1">{{error}}</div>\n            <div class="form-group">\n                <label for="id_password2">Repeat Password</label>\n                <input name="new_password2" id="id_password2" type="password" ng-model="model.new_password2" placeholder="Repeat Password" class="form-control" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.new_password2">{{error}}</div>\n            <button ng-show="authenticated" type="submit" class="btn btn-primary">Change Password</button>\n        </form>\n        <div class="alert alert-warning" ng-if="authenticated != true">You need to be logged in to do this!</div>\n    </div>\n    <div ng-if="complete == true">\n        <div class="alert alert-success">You have changed your password.</div>\n    </div>\n</div>\n'),e.put("app-templates/auth/views/passwordreset.html",'<div id="passwordReset_view" ng-controller="PasswordresetCtrl">\n    <div ng-if="complete == false">\n        <form role="form" ng-if="authenticated != true" name="passwordResetForm" ng-submit="resetPassword(passwordResetForm)" novalidate>\n            <div class="form-group">\n                <label for="id_email">Email</label>\n                <input name="email" id="id_email" type="text" ng-model="model.email" placeholder="Email" class="form-control" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\n            <button ng-hide="authenticated" type="submit" class="btn btn-primary">Reset Password</button>\n        </form>\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to reset your password.</p>\n    </div>\n    <div ng-if="complete == true">\n        <div class="alert alert-success">You should receive an email shortly with instructions on how to reset your account password.</div>\n    </div>\n</div>\n'),e.put("app-templates/auth/views/passwordresetconfirm.html",'<div id="passwordResetConfirm_view" ng-controller="PasswordresetconfirmCtrl">\n    <div ng-if="complete == false">\n        <form role="form" ng-if="authenticated != true" ng-submit="confirmReset(confirmResetForm)" name="confirmResetForm" novalidate>\n            <div class="form-group">\n                <label for="id_password1">New Password</label>\n                <input name="password1" id="id_password1" type="password" ng-model="model.new_password1" placeholder="New Password" class="form-control" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.password1">{{error}}</div>\n            <div class="form-group">\n                <label for="id_password2">Repeat Password</label>\n                <input name="password2" id="id_password2" type="password" ng-model="model.new_password2" placeholder="Repeat Password" class="form-control" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.password2">{{error}}</div>\n            <button type="submit" ng-hide="authenticated" class="btn btn-primary">Reset Password</button>\n        </form>\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to reset your password.</p>\n    </div>\n    <div ng-if="complete == true">\n        <div class="alert alert-success">You have changed your password.</div>\n    </div>\n</div>\n'),e.put("app-templates/auth/views/register.html",'<div id="register_view" ng-controller="RegisterCtrl">\n    <div ng-if="complete == false">\n        <form role="form" ng-if="authenticated != true" name="registerForm" ng-submit="register(registerForm)" novalidate>\n            <div class="form-group">\n                <label for="id_username">Username</label>\n                <input name="username" id="id_username" class="form-control" type="text" ng-model="model.username" placeholder="Username" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.username">{{error}}</div>\n            <div class="form-group">\n                <label for="id_password">Password</label>\n                <input name="password1" id="id_password1" class="form-control" type="password" ng-model="model.password1" placeholder="Password" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.password1">{{error}}</div>\n            <div class="form-group">\n                <label for="id_password">Repeat Password</label>\n                <input name="password" id="id_password2" class="form-control" type="password" ng-model="model.password2" placeholder="Repeat Password" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.password2">{{error}}</div>\n            <div class="form-group">\n                <label for="id_email">Email</label>\n                <input name="email" id="id_email" class="form-control" type="email" ng-model="model.email" placeholder="Email" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\n            <button ng-hide="authenticated" type="submit" class="btn btn-primary">Register</button>\n        </form>\n        <p ng-if="authenticated">You are already logged in!  You don\'t need to register.</p>\n    </div>\n    <div ng-if="complete == true">\n        <div class="alert alert-success">Great!  You\'ve just registered.  You should receive an email shortly with instructions on how to activate your account.</div>\n    </div>\n</div>'),e.put("app-templates/auth/views/restricted.html","<p>You have attempted to access a restricted page.  Please login to continue.</p>\n<div ng-include=\"'app-templates/auth/views/login.html'\"></div>\n"),e.put("app-templates/auth/views/userprofile.html",'<div id="userProfile_view" ng-controller="UserprofileCtrl">\n    <div ng-if="complete == false">\n        <form role="form" ng-if="authenticated" name="userProfileForm" ng-submit="updateProfile(userProfileForm, model)" novalidate>\n            <div class="form-group">\n                <label for="id_first_name">First Name</label>\n                <input name="first_name" id="id_first_name" class="form-control" type="text" ng-model="model.first_name" placeholder="First Name" />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.first_name">{{error}}</div>\n            <div class="form-group">\n                <label for="id_last_name">Last Name</label>\n                <input name="last_name" id="id_last_name" class="form-control" type="text" ng-model="model.last_name" placeholder="Last Name" />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.last_name">{{error}}</div>\n            <div class="form-group">\n                <label for="id_email">Email</label>\n                <input name="email" id="id_email" class="form-control" type="email" ng-model="model.email" placeholder="Email" required />\n            </div>\n            <div class="alert alert-danger" ng-repeat="error in errors.email">{{error}}</div>\n            <button type="submit" ng-show="authenticated" class="btn btn-primary">Update Profile</button>\n        </form>\n        <div class="alert alert-warning" ng-if="authenticated == false">You need to be logged in to do this.</div>\n    </div>\n    <div ng-if="complete == true">\n        <div class="alert alert-success">You have updated your profile.</div>\n    </div>\n</div>\n'),e.put("app-templates/auth/views/verifyemail.html",'<div id="verifyEmail_view" ng-controller="VerifyemailCtrl">\n	<div ng-if="success" class="alert alert-success">You have successfully verified your email address.</div>\n	<div ng-if="failure" class="alert alert-warning">Sorry, there\'s been an error.</div>\n</div>\n')}]);
//# sourceMappingURL=app.min.js.map
